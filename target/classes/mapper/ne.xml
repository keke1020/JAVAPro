<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mp.dao.neDao">
	<resultMap type="ne" id="neResult">
		<id column="jyuchu_denpyo_no" property="jyuchu_denpyo_no"
			jdbcType="INTEGER" />
		<result column="count" property="count" jdbcType="INTEGER" />
		<result column="pic_siji_naiyou" property="pic_siji_naiyou"
			jdbcType="VARCHAR" />
		<result column="jyuchu_bi" property="jyuchu_bi"
			jdbcType="TIMESTAMP" />
		<result column="syuka_kakutei_bi" property="syuka_kakutei_bi"
			jdbcType="TIMESTAMP" />
		<result column="nouhinsyo_insatusiji_bi"
			property="nouhinsyo_insatusiji_bi" jdbcType="TIMESTAMP" />
		<result column="nouhinsyo_insatuhakou_bi"
			property="nouhinsyo_insatuhakou_bi" jdbcType="TIMESTAMP" />
		<result column="jyuchu_jyotai_kbn" property="jyuchu_jyotai_kbn"
			jdbcType="VARCHAR" />
		<result column="tenpo_denpyo_no" property="tenpo_denpyo_no"
			jdbcType="VARCHAR" />
		<result column="tenpo_code" property="tenpo_code"
			jdbcType="VARCHAR" />
		<result column="jyuchu_tantou_code"
			property="jyuchu_tantou_code" jdbcType="VARCHAR" />
		<result column="jyuchu_name" property="jyuchu_name"
			jdbcType="VARCHAR" />
		<result column="syohin_kin" property="syohin_kin"
			jdbcType="INTEGER" />
		<result column="zei_kin" property="zei_kin" jdbcType="INTEGER" />
		<result column="hasou_kin" property="hasou_kin"
			jdbcType="INTEGER" />
		<result column="tesuryo_kin" property="tesuryo_kin"
			jdbcType="INTEGER" />
		<result column="sonota_kin" property="sonota_kin"
			jdbcType="INTEGER" />
		<result column="point" property="point" jdbcType="INTEGER" />
		<result column="goukei_kin" property="goukei_kin"
			jdbcType="INTEGER" />
		<result column="hasou_name" property="hasou_name"
			jdbcType="VARCHAR" />
		<result column="hasou_yubin_bangou"
			property="hasou_yubin_bangou" jdbcType="VARCHAR" />
		<result column="hasou_jyusyo" property="hasou_jyusyo"
			jdbcType="VARCHAR" />
		<result column="hasou_kbn" property="hasou_kbn"
			jdbcType="VARCHAR" />
		<result column="siharai_kbn" property="siharai_kbn"
			jdbcType="VARCHAR" />
		<result column="hasou_denpyo_no" property="hasou_denpyo_no"
			jdbcType="INTEGER" />
		<result column="bikou" property="bikou" jdbcType="VARCHAR" />
		<result column="jyuyou" property="jyuyou" jdbcType="VARCHAR" />
		<result column="jyuyou_check" property="jyuyou_check"
			jdbcType="VARCHAR" />
		<result column="jyuchu_tag" property="jyuchu_tag"
			jdbcType="VARCHAR" />
		<result column="import_date" property="import_date"
			jdbcType="TIMESTAMP" />
		<result column="import_user" property="import_user"
			jdbcType="INTEGER" />
		<result column="import_username" property="import_username"
			jdbcType="VARCHAR" />


		<result column="tsuisekiImportDate"
			property="tsuisekiImportDate" jdbcType="TIMESTAMP" />
		<result column="tsuisekiImportUserId"
			property="tsuisekiImportUserId" jdbcType="INTEGER" />
		<result column="tsuisekiImportUser"
			property="tsuisekiImportUser" jdbcType="VARCHAR" />
		<result column="sumi" property="sumi" jdbcType="VARCHAR" />
		<result column="todokesaki" property="todokesaki"
			jdbcType="VARCHAR" />
		<result column="kekka" property="kekka" jdbcType="VARCHAR" />
		<result column="haitatsukanryo" property="haitatsukanryo"
			jdbcType="TIMESTAMP" />
		<result column="haisoukaisya" property="haisoukaisya"
			jdbcType="VARCHAR" />
		<result column="kosuu" property="kosuu" jdbcType="VARCHAR" />
		<result column="syosai" property="syosai" jdbcType="VARCHAR" />
		<result column="syokaihannnou" property="syokaihannnou"
			jdbcType="TIMESTAMP" />
		<result column="syukabi" property="syukabi"
			jdbcType="TIMESTAMP" />
		<result column="tsuisekiNo" property="tsuisekiNo"
			jdbcType="VARCHAR" />

		<result column="code" property="code" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap type="ne_meisai" id="neMeisaiResult">
		<id column="jyuchu_denpyo_no" property="jyuchu_denpyo_no"
			jdbcType="INTEGER" />
		<result column="tenpo_code" property="tenpo_code" jdbcType="VARCHAR" />
		<result column="count" property="count" jdbcType="INTEGER" />
		<result column="code" property="code" jdbcType="VARCHAR" />
		<result column="name" property="name" jdbcType="VARCHAR" />
		<result column="meisaigyo" property="meisaigyo"
			jdbcType="INTEGER" />
		<result column="jyucyu_count" property="jyucyu_count"
			jdbcType="INTEGER" />
		<result column="hikiate_count" property="hikiate_count"
			jdbcType="INTEGER" />

		<result column="kingaku" property="kingaku" jdbcType="INTEGER" />
		<result column="gennka" property="gennka" jdbcType="INTEGER" />
	</resultMap>

	<resultMap type="ne_goods" id="neGoodsResult">
		<result column="code" property="code" jdbcType="VARCHAR" />
		<result column="dhcode" property="dhcode" jdbcType="VARCHAR" />
		<result column="name" property="name" jdbcType="VARCHAR" />
		<result column="baika" property="baika" jdbcType="VARCHAR" />
		<result column="genka" property="genka" jdbcType="VARCHAR" />
		<result column="teika" property="teika" jdbcType="VARCHAR" />
		<result column="tag" property="tag" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap type="ne_hikaku" id="neHikakuResult">
		<result column="code" property="code" jdbcType="VARCHAR" />
		<result column="value1" property="value1" jdbcType="VARCHAR" />
		<result column="value2" property="value2" jdbcType="VARCHAR" />
		<result column="value3" property="value3" jdbcType="VARCHAR" />
		<result column="value4" property="value4" jdbcType="VARCHAR" />
		<result column="value5" property="value5" jdbcType="VARCHAR" />
		<result column="value6" property="value6" jdbcType="VARCHAR" />
		<result column="value7" property="value7" jdbcType="VARCHAR" />
		<result column="value8" property="value8" jdbcType="VARCHAR" />
		<result column="value9" property="value9" jdbcType="VARCHAR" />
		<result column="value10" property="value10" jdbcType="VARCHAR" />
		<result column="value11" property="value11" jdbcType="VARCHAR" />
		<result column="value12" property="value12" jdbcType="VARCHAR" />
		<result column="value13" property="value13" jdbcType="VARCHAR" />
		<result column="value14" property="value14" jdbcType="VARCHAR" />
		<result column="value15" property="value15" jdbcType="VARCHAR" />
	</resultMap>

	<insert id="insert" parameterType="java.util.ArrayList">
		insert into `ne`
		(
		`jyuchu_denpyo_no`,
		`pic_siji_naiyou`,
		`jyuchu_bi`,
		`syuka_kakutei_bi`,
		`nouhinsyo_insatusiji_bi`,
		`nouhinsyo_insatuhakou_bi`,
		`jyuchu_jyotai_kbn`,
		`tenpo_denpyo_no`,
		`tenpo_code`,
		`jyuchu_tantou_code`,
		`jyuchu_name`,
		`syohin_kin`,
		`zei_kin`,
		`hasou_kin`,
		`tesuryo_kin`,
		`sonota_kin`,
		`point`,
		`goukei_kin`,
		`hasou_name`,
		`hasou_yubin_bangou`,
		`hasou_jyusyo`,
		`hasou_kbn`,
		`siharai_kbn`,
		`hasou_denpyo_no`,
		`bikou`,
		`jyuyou`,
		`jyuyou_check`,
		`jyuchu_tag`,
		`import_date`,
		`import_user`
		)
		values
		<foreach collection="list" item="item" index="index"
			separator=",">
			(
			#{item.jyuchu_denpyo_no},
			#{item.pic_siji_naiyou},
			#{item.jyuchu_bi},
			#{item.syuka_kakutei_bi},
			#{item.nouhinsyo_insatusiji_bi},
			#{item.nouhinsyo_insatuhakou_bi},
			#{item.jyuchu_jyotai_kbn},
			#{item.tenpo_denpyo_no},
			#{item.tenpo_code},
			#{item.jyuchu_tantou_code},
			#{item.jyuchu_name},
			#{item.syohin_kin},
			#{item.zei_kin},
			#{item.hasou_kin},
			#{item.tesuryo_kin},
			#{item.sonota_kin},
			#{item.point},
			#{item.goukei_kin},
			#{item.hasou_name},
			#{item.hasou_yubin_bangou},
			#{item.hasou_jyusyo},
			#{item.hasou_kbn},
			#{item.siharai_kbn},
			#{item.hasou_denpyo_no},
			#{item.bikou},
			#{item.jyuyou},
			#{item.jyuyou_check},
			#{item.jyuchu_tag},
			#{item.import_date},
			#{item.import_user}
			)
		</foreach>
		ON DUPLICATE KEY UPDATE
		`jyuchu_denpyo_no` =VALUES(`jyuchu_denpyo_no`),
		`pic_siji_naiyou` =VALUES(`pic_siji_naiyou`),
		`jyuchu_bi`=VALUES(`jyuchu_bi`),
		`syuka_kakutei_bi`=VALUES(`syuka_kakutei_bi`),
		`nouhinsyo_insatusiji_bi`=VALUES(`nouhinsyo_insatusiji_bi`),
		`nouhinsyo_insatuhakou_bi`=VALUES(`nouhinsyo_insatuhakou_bi`),
		`jyuchu_jyotai_kbn`=VALUES(`jyuchu_jyotai_kbn`),
		`tenpo_denpyo_no`=VALUES(`tenpo_denpyo_no`),
		`tenpo_code`=VALUES(`tenpo_code`),
		`jyuchu_tantou_code`=VALUES(`jyuchu_tantou_code`),
		`jyuchu_name`=VALUES(`jyuchu_name`),
		`syohin_kin`=VALUES(`syohin_kin`),
		`zei_kin`=VALUES(`zei_kin`),
		`hasou_kin`=VALUES(`hasou_kin`),
		`tesuryo_kin`=VALUES(`tesuryo_kin`),
		`sonota_kin`=VALUES(`sonota_kin`),
		`point`=VALUES(`point`),
		`goukei_kin`=VALUES(`goukei_kin`),
		`hasou_name`=VALUES(`hasou_name`),
		`hasou_yubin_bangou`=VALUES(`hasou_yubin_bangou`),
		`hasou_jyusyo`=VALUES(`hasou_jyusyo`),
		`hasou_kbn`=VALUES(`hasou_kbn`),
		`siharai_kbn`=VALUES(`siharai_kbn`),
		`hasou_denpyo_no`=VALUES(`hasou_denpyo_no`),
		`bikou`=VALUES(`bikou`),
		`jyuyou`=VALUES(`jyuyou`),
		`jyuyou_check`=VALUES(`jyuyou_check`),
		`jyuchu_tag`=VALUES(`jyuchu_tag`)
	</insert>

	<select id="getHomedata_keisan" resultMap="neResult">
		SELECT
			sum(goukei_kin) as goukei_kin,
			sum(hasou_kin) as hasou_kin,
			sum(zei_kin) as zei_kin,
			sum(syohin_kin) as syohin_kin,
			sum(tesuryo_kin) as tesuryo_kin,
			sum(sonota_kin) as sonota_kin,
			sum(point) as point
		FROM
			ne
		WHERE
			tenpo_code = #{tenpo}
			AND jyuchu_bi &gt;= #{start}
			AND jyuchu_bi &lt;= #{end}
	</select>


	<select id="getHomeDataByNe_everday" resultMap="neResult">
		SELECT
		sum(goukei_kin) AS goukei_kin,
		jyuchu_bi,
		jyuchu_name
		FROM
		ne
		WHERE
		jyuchu_bi
		&gt;= #{time_s} AND jyuchu_bi &lt;= #{time_e}
		<if test="tenpo != '' and tenpo != null">
			AND tenpo_code = #{tenpo}
		</if>
		group by jyuchu_name
	</select>

	<select id="getHomeTenpoinfoDataByNe_month" resultMap="neResult">
		SELECT
		jyuchu_name,
		(
		SELECT
		sum(goukei_kin)
		FROM
		ne n2
		WHERE
		n2.tenpo_code =
		#{tenpo}
		AND n2.jyuchu_name = n1.jyuchu_name
		<if
			test="start != '' and start != null and end != '' and end != null">
			AND n2.jyuchu_bi &gt;= #{start}
			AND n2.jyuchu_bi &lt;= #{end}
		</if>
		) AS goukei_kin,
		(
		SELECT
		count(*)
		FROM
		ne n3
		WHERE
		n3.tenpo_code = #{tenpo}
		AND n3.jyuchu_name = n1.jyuchu_name
		<if
			test="start != '' and start != null and end != '' and end != null">
			AND n3.jyuchu_bi &gt;= #{start}
			AND n3.jyuchu_bi &lt;= #{end}
		</if>
		) AS count
		FROM
		ne n1
		WHERE
		tenpo_code = #{tenpo}
		<if
			test="start != '' and start != null and end != '' and end != null">
			AND jyuchu_bi &gt;= #{start}
			AND jyuchu_bi &lt;= #{end}
		</if>
		GROUP BY
		jyuchu_name
		ORDER BY
		goukei_kin DESC
		LIMIT #{current},
		#{pageCount}
	</select>

	<select id="getHomeTenpoinfoCountDataByNe_month"
		resultType="java.lang.Integer">
		SELECT
		count(*)
		FROM
		(
		select
		jyuchu_name
		from
		ne
		WHERE
		tenpo_code = #{tenpo}
		<if
			test="start != '' and start != null and end != '' and end != null">
			AND jyuchu_bi &gt;= #{start}
			AND jyuchu_bi &lt;= #{end}
		</if>
		GROUP BY
		jyuchu_name
		) n
	</select>

	<select id="getHomeTenpoinfo2DataByNe_month"
		resultMap="neMeisaiResult">
		SELECT
		nm.code,
		(SELECT
		SUM(nm2.kingaku)
		FROM
		ne_meisai nm2
		LEFT JOIN ne n2 ON nm2.jyuchu_denpyo_no = n2.jyuchu_denpyo_no
		WHERE
		nm2. CODE = nm.code
		AND n2.tenpo_code = #{tenpo}
		AND n2.jyuchu_bi &gt;= #{start}
		AND n2.jyuchu_bi &lt;= #{end}
		) as kingaku,
		(SELECT
				SUM(nm3.hikiate_count)
			FROM
				ne_meisai nm3
			LEFT JOIN ne n3 ON nm3.jyuchu_denpyo_no = n3.jyuchu_denpyo_no
			WHERE
				nm3. CODE = nm.code
				AND n3.tenpo_code = #{tenpo}
				AND n3.jyuchu_bi &gt;= #{start}
				AND n3.jyuchu_bi &lt;= #{end}
		) as count
		FROM
		ne_meisai nm
		LEFT JOIN ne n ON nm.jyuchu_denpyo_no = n.jyuchu_denpyo_no
		where
		n.tenpo_code = #{tenpo}
		AND n.jyuchu_bi &gt;= #{start}
		AND n.jyuchu_bi &lt;= #{end}
		GROUP BY nm.code
		ORDER BY kingaku desc
		LIMIT #{current},
		#{pageCount}
	</select>

	<select id="getHomeTenpoinfo2CountDataByNe_month"
		resultType="java.lang.Integer">
		SELECT
			count(*)
		FROM
		(
			SELECT code from ne_meisai nm
			LEFT JOIN ne n ON nm.jyuchu_denpyo_no = n.jyuchu_denpyo_no
			where
				n.tenpo_code = #{tenpo}
				AND n.jyuchu_bi &gt;= #{start}
				AND n.jyuchu_bi &lt;= #{end}
			GROUP BY nm.code
		) n
	</select>

	<select id="getHomeKakuTenpoinfoDataByNe"
		resultMap="neHikakuResult">
		SELECT
			nm_master.`code` AS `code`,
			(
				SELECT
					SUM(nm1.jyucyu_count)
				FROM
					ne_meisai nm1
				JOIN ne n1 ON nm1.jyuchu_denpyo_no = n1.jyuchu_denpyo_no
				WHERE
					n1.jyuchu_bi &gt;= #{start}
				AND n1.jyuchu_bi &lt;= #{end}
				AND n1.tenpo_code = 'あかね楽天'
				AND nm1.`code` = nm_master.`code`
			) AS value1,
			(
				SELECT
					SUM(nm2.jyucyu_count)
				FROM
					ne_meisai nm2
				JOIN ne n2 ON nm2.jyuchu_denpyo_no = n2.jyuchu_denpyo_no
				WHERE
					n2.jyuchu_bi &gt;= #{start}
				AND n2.jyuchu_bi &lt;= #{end}
				AND n2.tenpo_code = 'アリス'
				AND nm2.`code` = nm_master.`code`
			) AS value2,
			(
				SELECT
					SUM(nm3.jyucyu_count)
				FROM
					ne_meisai nm3
				JOIN ne n3 ON nm3.jyuchu_denpyo_no = n3.jyuchu_denpyo_no
				WHERE
					n3.jyuchu_bi &gt;= #{start}
				AND n3.jyuchu_bi &lt;= #{end}
				AND n3.tenpo_code = '暁'
				AND nm3.`code` = nm_master.`code`
			) AS value3,
			(
				SELECT
					SUM(nm4.jyucyu_count)
				FROM
					ne_meisai nm4
				JOIN ne n4 ON nm4.jyuchu_denpyo_no = n4.jyuchu_denpyo_no
				WHERE
					n4.jyuchu_bi &gt;= #{start}
				AND n4.jyuchu_bi &lt;= #{end}
				AND n4.tenpo_code = 'あかねY'
				AND nm4.`code` = nm_master.`code`
			) AS value4,
			(
				SELECT
					SUM(nm5.jyucyu_count)
				FROM
					ne_meisai nm5
				JOIN ne n5 ON nm5.jyuchu_denpyo_no = n5.jyuchu_denpyo_no
				WHERE
					n5.jyuchu_bi &gt;= #{start}
				AND n5.jyuchu_bi &lt;= #{end}
				AND n5.tenpo_code = 'FK'
				AND nm5.`code` = nm_master.`code`
			) AS value5,
			(
				SELECT
					SUM(nm6.jyucyu_count)
				FROM
					ne_meisai nm6
				JOIN ne n6 ON nm6.jyuchu_denpyo_no = n6.jyuchu_denpyo_no
				WHERE
					n6.jyuchu_bi &gt;= #{start}
				AND n6.jyuchu_bi &lt;= #{end}
				AND n6.tenpo_code = 'ヤフーKT'
				AND nm6.`code` = nm_master.`code`
			) AS value6,
			(
				SELECT
					SUM(nm7.jyucyu_count)
				FROM
					ne_meisai nm7
				JOIN ne n7 ON nm7.jyuchu_denpyo_no = n7.jyuchu_denpyo_no
				WHERE
					n7.jyuchu_bi &gt;= #{start}
				AND n7.jyuchu_bi &lt;= #{end}
				AND n7.tenpo_code = 'YオクKT'
				AND nm7.`code` = nm_master.`code`
			) AS value7,
			(
				SELECT
					SUM(nm8.jyucyu_count)
				FROM
					ne_meisai nm8
				JOIN ne n8 ON nm8.jyuchu_denpyo_no = n8.jyuchu_denpyo_no
				WHERE
					n8.jyuchu_bi &gt;= #{start}
				AND n8.jyuchu_bi &lt;= #{end}
				AND n8.tenpo_code = 'ラキナイ'
				AND nm8.`code` = nm_master.`code`
			) AS value8,
			(
				SELECT
					SUM(nm9.jyucyu_count)
				FROM
					ne_meisai nm9
				JOIN ne n9 ON nm9.jyuchu_denpyo_no = n9.jyuchu_denpyo_no
				WHERE
					n9.jyuchu_bi &gt;= #{start}
				AND n9.jyuchu_bi &lt;= #{end}
				AND n9.tenpo_code = '問屋よか'
				AND nm9.`code` = nm_master.`code`
			) AS value9,
			(
				SELECT
					SUM(nm10.jyucyu_count)
				FROM
					ne_meisai nm10
				JOIN ne n10 ON nm10.jyuchu_denpyo_no = n10.jyuchu_denpyo_no
				WHERE
					n10.jyuchu_bi &gt;= #{start}
				AND n10.jyuchu_bi &lt;= #{end}
				AND n10.tenpo_code = 'とんよか卸'
				AND nm10.`code` = nm_master.`code`
			) AS value10,
			(
				SELECT
					SUM(nm11.jyucyu_count)
				FROM
					ne_meisai nm11
				JOIN ne n11 ON nm11.jyuchu_denpyo_no = n11.jyuchu_denpyo_no
				WHERE
					n11.jyuchu_bi &gt;= #{start}
				AND n11.jyuchu_bi &lt;= #{end}
				AND n11.tenpo_code = 'クラナビ'
				AND nm11.`code` = nm_master.`code`
			) AS value11,
			(
				SELECT
					SUM(nm12.jyucyu_count)
				FROM
					ne_meisai nm12
				JOIN ne n12 ON nm12.jyuchu_denpyo_no = n12.jyuchu_denpyo_no
				WHERE
					n12.jyuchu_bi &gt;= #{start}
				AND n12.jyuchu_bi &lt;= #{end}
				AND n12.tenpo_code = 'AZアリス'
				AND nm12.`code` = nm_master.`code`
			) AS value12,
			(
				SELECT
					SUM(nm13.jyucyu_count)
				FROM
					ne_meisai nm13
				JOIN ne n13 ON nm13.jyuchu_denpyo_no = n13.jyuchu_denpyo_no
				WHERE
					n13.jyuchu_bi &gt;= #{start}
				AND n13.jyuchu_bi &lt;= #{end}
				AND n13.tenpo_code = 'フリット'
				AND nm13.`code` = nm_master.`code`
			) AS value13,
			(
				SELECT
					SUM(nm14.jyucyu_count)
				FROM
					ne_meisai nm14
				JOIN ne n14 ON nm14.jyuchu_denpyo_no = n14.jyuchu_denpyo_no
				WHERE
					n14.jyuchu_bi &gt;= #{start}
				AND n14.jyuchu_bi &lt;= #{end}
				AND n14.tenpo_code = 'トココ'
				AND nm14.`code` = nm_master.`code`
			) AS value14,
			(
				SELECT
					SUM(nm15.jyucyu_count)
				FROM
					ne_meisai nm15
				JOIN ne n15 ON nm15.jyuchu_denpyo_no = n15.jyuchu_denpyo_no
				WHERE
					n15.jyuchu_bi &gt;= #{start}
				AND n15.jyuchu_bi &lt;= #{end}
				AND n15.tenpo_code = 'サラダ'
				AND nm15.`code` = nm_master.`code`
			) AS value15
		FROM
			ne n
		JOIN ne_meisai nm_master ON nm_master.jyuchu_denpyo_no = n.jyuchu_denpyo_no
		WHERE
			n.jyuchu_bi &gt;= #{start}
		AND n.jyuchu_bi &lt;= #{end}
		<choose>
            <when test="codes.size() > 0">
            	AND nm_master.`code` in
                <foreach collection="codes" item="code" index="index" open="("
					close=")" separator=",">
					#{code}
				</foreach>
            </when>
            <otherwise>

            </otherwise>
        </choose>
        GROUP BY nm_master.`code`
	</select>

	<select id="getHomeKakuTenpoinfoCodeDataByNe"
		resultType="java.lang.String">
		SELECT
			DISTINCT nm.`code`
		FROM
			ne n
		JOIN ne_meisai nm ON nm.jyuchu_denpyo_no = n.jyuchu_denpyo_no
		WHERE
			n.jyuchu_bi &gt;= #{start}
		AND n.jyuchu_bi &lt;= #{end}
		AND nm.`code` is not null AND nm.`code` != ''
	</select>

	<select id="getMeisaiDataByNe" resultMap="neResult">
		SELECT
		`jyuchu_denpyo_no`,
		`pic_siji_naiyou`,
		`jyuchu_bi`,
		`syuka_kakutei_bi`,
		`nouhinsyo_insatusiji_bi`,
		`nouhinsyo_insatuhakou_bi`,
		`jyuchu_jyotai_kbn`,
		`tenpo_denpyo_no`,
		`tenpo_code`,
		`jyuchu_tantou_code`,
		`jyuchu_name`,
		`syohin_kin`,
		`zei_kin`,
		`hasou_kin`,
		`tesuryo_kin`,
		`sonota_kin`,
		`point`,
		`goukei_kin`,
		`hasou_name`,
		`hasou_yubin_bangou`,
		`hasou_jyusyo`,
		`hasou_kbn`,
		`siharai_kbn`,
		`hasou_denpyo_no`,
		`bikou`,
		`jyuyou`,
		`jyuyou_check`,
		`jyuchu_tag`,
		`import_date`,
		`import_user`,
		(select
		realname from `user` where ID = import_user LIMIT 1) as
		import_username,
		`sumi`,
		`kekka`,
		`todokesaki`,
		`haitatsukanryo`,
		`haisoukaisya`,
		`kosuu`,
		`syosai`,
		`syokaihannnou`,
		`syukabi`,
		`tsuisekiImportDate`,
		`tsuisekiNo`,
		(select realname from `user` where
		ID = tsuisekiImportUserId LIMIT 1) as
		tsuisekiImportUser
		FROM
		ne
		WHERE 1=1
		<if test="tenpo != '' and tenpo != null">
			and tenpo_code = #{tenpo}
		</if>
		<if test="jyuchu_name != '' and jyuchu_name != null">
			and jyuchu_name = #{jyuchu_name}
		</if>
		<if test="denpyono != '' and denpyono != null">
			and jyuchu_denpyo_no = #{denpyono}
		</if>
		<if test="haitatsukanryo_chk == 'true'">
			and (haitatsukanryo is null or haitatsukanryo = '')
		</if>
		<if test="haitatsukanryo_chk2 == 'true'">
			and (haitatsukanryo is not null or haitatsukanryo != '')
		</if>
		<if test="kekka != '' and kekka != null">
			<choose>
				<when test="kekka == '配達未完了'">
					and (kekka != '配達完了' or kekka is null)
				</when>
				<otherwise>
					and kekka = #{kekka}
				</otherwise>
			</choose>
		</if>
		<if test="jyuchu_haisokaisya != '' and jyuchu_haisokaisya != null">
			and haisoukaisya = #{jyuchu_haisokaisya}
		</if>
		<if
			test="haitatsukanryo_chk == 'false' and haitatsukanryo_chk2 == 'false'">
			<if
				test="haitatsukanryo_s != '' and haitatsukanryo_s != null and haitatsukanryo_e != '' and haitatsukanryo_e != null">
				and haitatsukanryo &gt;= #{haitatsukanryo_s} and haitatsukanryo
				&lt;=
				#{haitatsukanryo_e}
			</if>
		</if>
		<choose>
			<when test="time_s == '' and time_e == ''">
			</when>
			<when test="time_s != '' and time_e != ''">
				AND jyuchu_bi &gt;= #{time_s} AND jyuchu_bi &lt;=
				#{time_e}
			</when>
			<when test="time_s != '' and time_e == ''">
				AND jyuchu_bi &gt;= #{time_s}
			</when>
			<when test="time_s == '' and time_e != ''">
				AND jyuchu_bi &lt;= #{time_e}
			</when>
			<otherwise>
			</otherwise>
		</choose>
		order by jyuchu_name
		LIMIT #{current}, #{pageCount}
	</select>

	<select id="getMeisaiDataByNe_count"
		resultType="java.lang.Integer">
		SELECT
		count(*)
		FROM
		ne
		WHERE 1=1
		<if test="tenpo != '' and tenpo != null">
			and tenpo_code = #{tenpo}
		</if>
		<if test="jyuchu_name != '' and jyuchu_name != null">
			and jyuchu_name = #{jyuchu_name}
		</if>
		<if test="denpyono != '' and denpyono != null">
			and jyuchu_denpyo_no = #{denpyono}
		</if>
		<if test="haitatsukanryo_chk == 'true'">
			and (haitatsukanryo is null or haitatsukanryo = '')
		</if>
		<if test="haitatsukanryo_chk2 == 'true'">
			and (haitatsukanryo is not null or haitatsukanryo != '')
		</if>
		<if test="kekka != '' and kekka != null">
			<choose>
				<when test="kekka == '配達未完了'">
					and (kekka != '配達完了' or kekka is null)
				</when>
				<otherwise>
					and kekka = #{kekka}
				</otherwise>
			</choose>
		</if>
		<if test="jyuchu_haisokaisya != '' and jyuchu_haisokaisya != null">
			and haisoukaisya = #{jyuchu_haisokaisya}
		</if>
		<if
			test="haitatsukanryo_chk == 'false' and haitatsukanryo_chk2 == 'false'">
			<if
				test="haitatsukanryo_s != '' and haitatsukanryo_s != null and haitatsukanryo_e != '' and haitatsukanryo_e != null">
				and haitatsukanryo &gt;= #{haitatsukanryo_s} and haitatsukanryo
				&lt;=
				#{haitatsukanryo_e}
			</if>
		</if>
		<choose>
			<when test="time_s == '' and time_e == ''">
			</when>
			<when test="time_s != '' and time_e != ''">
				AND jyuchu_bi &gt;= #{time_s} AND jyuchu_bi &lt;=
				#{time_e}
			</when>
			<when test="time_s != '' and time_e == ''">
				AND jyuchu_bi &gt;= #{time_s}
			</when>
			<when test="time_s == '' and time_e != ''">
				AND jyuchu_bi &lt;= #{time_e}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>

	<select id="getHomedata_goukei"
		resultType="java.lang.Integer">
		SELECT
			sum(goukei_kin)
		FROM
			ne
		WHERE
			tenpo_code = #{tenpo}
			AND jyuchu_bi &gt;= #{start}
			AND jyuchu_bi &lt;= #{end}
	</select>

	<select id="getMeisaiDataByNe_goukei"
		resultType="java.lang.Integer">
		SELECT
		sum(goukei_kin)
		FROM
		ne
		WHERE 1=1
		<if test="tenpo != '' and tenpo != null">
			and tenpo_code = #{tenpo}
		</if>
		<if test="jyuchu_name != '' and jyuchu_name != null">
			and jyuchu_name = #{jyuchu_name}
		</if>
		<if test="denpyono != '' and denpyono != null">
			and jyuchu_denpyo_no = #{denpyono}
		</if>
		<if test="haitatsukanryo_chk == 'true'">
			and (haitatsukanryo is null or haitatsukanryo = '')
		</if>
		<if test="haitatsukanryo_chk2 == 'true'">
			and (haitatsukanryo is not null or haitatsukanryo != '')
		</if>
		<if test="kekka != '' and kekka != null">
			<choose>
				<when test="kekka == '配達未完了'">
					and (kekka != '配達完了' or kekka is null)
				</when>
				<otherwise>
					and kekka = #{kekka}
				</otherwise>
			</choose>
		</if>
		<if test="jyuchu_haisokaisya != '' and jyuchu_haisokaisya != null">
			and haisoukaisya = #{jyuchu_haisokaisya}
		</if>
		<if
			test="haitatsukanryo_chk == 'false' and haitatsukanryo_chk2 == 'false'">
			<if
				test="haitatsukanryo_s != '' and haitatsukanryo_s != null and haitatsukanryo_e != '' and haitatsukanryo_e != null">
				and haitatsukanryo &gt;= #{haitatsukanryo_s} and haitatsukanryo
				&lt;=
				#{haitatsukanryo_e}
			</if>
		</if>
		<choose>
			<when test="time_s == '' and time_e == ''">
			</when>
			<when test="time_s != '' and time_e != ''">
				AND jyuchu_bi &gt;= #{time_s} AND jyuchu_bi &lt;=
				#{time_e}
			</when>
			<when test="time_s != '' and time_e == ''">
				AND jyuchu_bi &gt;= #{time_s}
			</when>
			<when test="time_s == '' and time_e != ''">
				AND jyuchu_bi &lt;= #{time_e}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>

	<delete id="deleteMeisaiByIds">
		delete from `ne`
		WHERE
		`jyuchu_denpyo_no` in
		<foreach collection="ids" item="id" index="index" open="("
			close=")" separator=",">
			#{id}
		</foreach>
	</delete>

	<update id="UpdateTsuisekiData"
		parameterType="java.util.ArrayList">

		<foreach collection="list" item="item" index="index" open=""
			close="" separator=";">
			UPDATE `ne`
			<set>
				`sumi`=#{item.sumi},
				`kekka`=#{item.kekka},
				`tsuisekiNo`=#{item.tsuisekiNo},
				`todokesaki`=#{item.todokesaki},
				`haitatsukanryo`=#{item.haitatsukanryo},
				`haisoukaisya`=#{item.haisoukaisya},
				`kosuu`=#{item.kosuu},
				`syosai`=#{item.syosai},
				`syokaihannnou`=#{item.syokaihannnou},
				`syukabi`=#{item.syukabi},
				`tsuisekiImportDate`=#{item.tsuisekiImportDate},
				`tsuisekiImportUserId`=#{item.tsuisekiImportUserId},
			</set>
			WHERE `jyuchu_denpyo_no`= #{item.jyuchu_denpyo_no}
			<!-- `hasou_denpyo_no` = #{item.hasou_denpyo_no} -->
		</foreach>
	</update>

	<delete id="deleteByDenpyono">
		delete from `ne_meisai`
		WHERE
		`jyuchu_denpyo_no` in
		<foreach collection="ids" item="id" index="index" open="("
			close=")" separator=",">
			#{id}
		</foreach>
	</delete>

	<insert id="insertNeMeisai" parameterType="java.util.ArrayList">
		insert into `ne_meisai`
		(
		`jyuchu_denpyo_no`,
		`code`,
		`name`,
		`meisaigyo`,
		`jyucyu_count`,
		`hikiate_count`,
		`kingaku`,
		`gennka`
		)
		values
		<foreach collection="list" item="item" index="index"
			separator=",">
			(
			#{item.jyuchu_denpyo_no},
			#{item.code},
			#{item.name},
			#{item.meisaigyo},
			#{item.jyucyu_count},
			#{item.hikiate_count},
			#{item.kingaku},
			#{item.gennka}
			)
		</foreach>
	</insert>

	<insert id="insertGoods" parameterType="java.util.ArrayList">
		insert into `ne_goods`
		(
		`code`,
		`dhcode`,
		`name`,
		`baika`,
		`genka`,
		`teika`,
		`tag`
		)
		values
		<foreach collection="list" item="item" index="index"
			separator=",">
			(
			#{item.code},
			#{item.dhcode},
			#{item.name},
			#{item.baika},
			#{item.genka},
			#{item.teika},
			#{item.tag}
			)
		</foreach>
		ON DUPLICATE KEY UPDATE
		`dhcode` =VALUES(`dhcode`),
		`name`
		=VALUES(`name`),
		`baika`=VALUES(`baika`),
		`genka`=VALUES(`genka`),
		`teika`=VALUES(`teika`),
		`tag`=VALUES(`tag`)
	</insert>
</mapper>