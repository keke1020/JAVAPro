<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mp.dao.planDao">
	<resultMap type="plan" id="planResult">
		<id column="ID" property="ID" jdbcType="INTEGER" />
		<result column="title" property="title" jdbcType="VARCHAR" />
		<result column="link" property="link" jdbcType="VARCHAR" />
		<result column="info" property="info" jdbcType="CLOB" />
		<result column="state" property="state" jdbcType="INTEGER" />
		<result column="user_id" property="user_id" jdbcType="INTEGER" />
		<result column="updatetime" property="updatetime"
			jdbcType="TIMESTAMP" />
		<result column="updater" property="updater" jdbcType="VARCHAR" />
	</resultMap>

	<insert id="insert" parameterType="com.mp.entity.plan"
		useGeneratedKeys="true" keyProperty="ID" keyColumn="ID">
		insert into
		plan(`title`,
		`info`, `link`, `state`,`user_id`, `updatetime`)
		values(
		#{title},
		#{info},
		#{link},
		#{state},
		#{user_id},
		#{updatetime}
		)
	</insert>

	<select id="getPlan" resultMap="planResult">
		SELECT
		ID,
		title,
		info,
		link,
		state,
		updatetime,
		(select realname from `user` where ID = user_id limit 1) as updater
		FROM
		plan
	</select>

	<select id="getPlanById" resultMap="planResult">
		SELECT
		ID,
		title,
		info,
		link,
		state,
		updatetime,
		(select realname from `user` where ID = user_id limit 1) as updater
		FROM
		plan
		where
		ID = #{id}
	</select>



</mapper>